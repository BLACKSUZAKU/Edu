{extend name="./base.html"}
{block name="title"}
<title>响应式 - by developer.cn.com </title>
{/block}
{block name="header"}
    <link rel="stylesheet" type="text/css" href="{$Think.BASE}/resources/csschat/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{$Think.BASE}/resources/csschat/style.css">
    <link rel="stylesheet" type="text/css" href="{$Think.BASE}/resources/csschat/jquery.mobile.flatui.css" />
{/}
{block name="content"}
<div data-role="page">
    <div data-role="content" class="container" role="main">
        <ul class="content-reply-box mg10">


        </ul>
        <ul class="operating row text-center linear-g">
            <textarea name="" id="question" cols="30" rows="10"></textarea><button id="submit" onclick="submit()">提交</button>
        </ul>
    </div>
</div>
<script type="text/javascript" src="{$Think.BASE}/resources/js/jquery.min.js"></script>
<script type="text/javascript" src="{$Think.BASE}/resources/js/jquery.mobile-1.4.0-rc.1.js"></script>
<script type="text/javascript">
    Date.prototype.Format = function(fmt)
    { //author: meizz
        var o = {
            "M+" : this.getMonth()+1,                 //月份
            "d+" : this.getDate(),                    //日
            "h+" : this.getHours(),                   //小时
            "m+" : this.getMinutes(),                 //分
            "s+" : this.getSeconds(),                 //秒
            "q+" : Math.floor((this.getMonth()+3)/3), //季度
            "S"  : this.getMilliseconds()             //毫秒
        };
        if(/(y+)/.test(fmt))
            fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
            if(new RegExp("("+ k +")").test(fmt))
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
        return fmt;
    }
	$(function(){
		/* 
		** 不同页面切换转场效果
		** $.mobile.changePage ('/test.html', 'slide/pop/fade/slideup/slidedown/flip/none', false, false);
		*/
		$('.list-group-item,.menu a').click(function(){
			$.mobile.changePage($(this).attr('href'), {
				transition : 'flip', //转场效果
				reverse : true       //默认为false,设置为true时将导致一个反方向的转场
			});	
		});
            $("#question").keydown(function(e){
                var curKey = e.which;
                if(curKey == 13){
                    submit();
                    return false;
                }
            });
    });
    function ask(question){
        var div = document.getElementsByClassName("content-reply-box")[0];
        var content = document.createElement("div");
        content.innerHTML = '<li class="even"><a class="user" href="#"><img class="img-responsive avatar_" src="{$Think.BASE}/resources/images/avatar-1.png" alt=""><span class="user-name">{$user.nickname}</span></a> <div class="reply-content-box"> <span class="reply-time">'+new Date().Format("hh:mm:ss")+'</span> <div class="reply-content pr"> <span class="arrow">&nbsp;</span>'+question+'</div> </div> </li>';
        div.appendChild(content);
    }
    function answer(answer){
        var div = document.getElementsByClassName("content-reply-box")[0];
        var content = document.createElement("div");
        content.innerHTML = '<li class="odd"><a class="user" href="#"><img class="img-responsive avatar_" src="{$Think.BASE}/resources/images/avatar-1.png" alt=""><span class="user-name">图图老师</span></a> <div class="reply-content-box"> <span class="reply-time">'+new Date().Format("hh:mm:ss")+'</span> <div class="reply-content pr"> <span class="arrow">&nbsp;</span>'+answer+'</div> </div> </li>';
        div.appendChild(content);
    }
    function submit(){
        ask($("#question").val());
        $.ajax({
            type: "POST",
            url: "{$Think.BASE}/public/index.php/turing/turing/talk",
            data: {"message": $("#question").val()},
            dataType:"json",
            success: function(data){
                $("#question").val("")
                answer(data.content);
            }
        });
    }

</script>
{/block}